<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Haori.js „Éá„É¢</title>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        h2 {
            color: #4CAF50;
            margin-top: 30px;
            border-left: 4px solid #4CAF50;
            padding-left: 10px;
        }
        .demo-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: #fafafa;
        }
        .output {
            background: #e8f5e9;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
            border-left: 4px solid #4CAF50;
        }
        .dom-viewer {
            background: #263238;
            color: #aed581;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        button, input[type="submit"] {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            border-radius: 4px;
            font-size: 14px;
            transition: background 0.3s;
        }
        button:hover, input[type="submit"]:hover {
            background: #45a049;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        input[type="text"], input[type="number"], select, textarea {
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 100%;
            max-width: 300px;
        }
        label {
            display: block;
            margin: 10px 0 5px 0;
            font-weight: bold;
            color: #555;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background: #4CAF50;
            color: white;
        }
        tr:nth-child(even) {
            background: #f9f9f9;
        }
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #323232;
            color: white;
            padding: 15px 20px;
            border-radius: 4px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        ul {
            list-style: none;
            padding: 0;
        }
        li {
            padding: 8px;
            margin: 5px 0;
            background: white;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
        }
        .show-dom-btn {
            background: #2196F3;
            margin-left: 10px;
        }
        .show-dom-btn:hover {
            background: #1976D2;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Haori.js „Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Éá„É¢</h1>
        <p>„Åì„ÅÆ„Éö„Éº„Ç∏„ÅØ„ÄÅHaori.js„ÅÆÊ©üËÉΩ„ÇíHTMLÂ±ûÊÄß„ÅÆ„Åø„ÅßÂÆüÁèæ„Åó„Åü„Éá„É¢„Åß„Åô„ÄÇ</p>

        <!-- 1. „Éá„Éº„Çø„Éê„Ç§„É≥„Éá„Ç£„É≥„Ç∞ -->
        <h2>1. „Éá„Éº„Çø„Éê„Ç§„É≥„Éá„Ç£„É≥„Ç∞</h2>
        <div class="demo-section" id="demo1">
            <div data-bind='{"name":"Áî∞‰∏≠Â§™ÈÉé","age":25,"city":"Êù±‰∫¨"}'>
                <div class="output">
                    <p><strong>ÂêçÂâç:</strong> {{name}}</p>
                    <p><strong>Âπ¥ÈΩ¢:</strong> {{age}}Ê≠≥</p>
                    <p><strong>ÈÉΩÂ∏Ç:</strong> {{city}}</p>
                </div>
            </div>
            <button class="show-dom-btn" data-demo-id="demo1">DOM„ÇíË°®Á§∫</button>
            <div id="dom-demo1" class="dom-viewer" style="display:none;"></div>
        </div>

        <!-- 2. Êù°‰ª∂ÂàÜÂ≤ê -->
        <h2>2. Êù°‰ª∂ÂàÜÂ≤ê (data-if)</h2>
        <div class="demo-section" id="demo2">
            <div data-bind='{"showMessage":true,"count":5}'>
                <label>
                    <input type="checkbox" name="showMessage">
                    „É°„ÉÉ„Çª„Éº„Ç∏„ÇíË°®Á§∫
                </label>

                <div class="output">
                    <p data-if="showMessage">‚úÖ „É°„ÉÉ„Çª„Éº„Ç∏„ÅåË°®Á§∫„Åï„Çå„Å¶„ÅÑ„Åæ„Åô</p>
                    <p data-if="!showMessage">‚ùå „É°„ÉÉ„Çª„Éº„Ç∏„ÅØÈùûË°®Á§∫„Åß„Åô</p>
                    <p data-if="count >= 5">„Ç´„Ç¶„É≥„Éà„ÅØ5‰ª•‰∏ä„Åß„Åô (ÁèæÂú®: {{count}})</p>
                </div>
            </div>
            <button class="show-dom-btn" data-demo-id="demo2">DOM„ÇíË°®Á§∫</button>
            <div id="dom-demo2" class="dom-viewer" style="display:none;"></div>
        </div>

        <!-- 3. „É™„Çπ„ÉàË°®Á§∫ -->
        <h2>3. „É™„Çπ„ÉàË°®Á§∫ (data-each)</h2>
        <div class="demo-section" id="demo3">
            <div data-bind='{"users":[{"id":1,"name":"Áî∞‰∏≠Â§™ÈÉé","age":25},{"id":2,"name":"‰ΩêËó§Ëä±Â≠ê","age":30},{"id":3,"name":"Èà¥Êú®‰∏ÄÈÉé","age":28}]}'>
                <div class="output">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>ÂêçÂâç</th>
                                <th>Âπ¥ÈΩ¢</th>
                            </tr>
                        </thead>
                        <tbody data-each="users" data-each-key="id">
                            <tr>
                                <td>{{id}}</td>
                                <td>{{name}}</td>
                                <td>{{age}}Ê≠≥</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <button class="show-dom-btn" data-demo-id="demo3">DOM„ÇíË°®Á§∫</button>
            <div id="dom-demo3" class="dom-viewer" style="display:none;"></div>
        </div>

        <!-- 4. „Éï„Ç©„Éº„É†ÂèåÊñπÂêë„Éê„Ç§„É≥„Éá„Ç£„É≥„Ç∞ -->
        <h2>4. „Éï„Ç©„Éº„É†ÂèåÊñπÂêë„Éê„Ç§„É≥„Éá„Ç£„É≥„Ç∞</h2>
        <div class="demo-section" id="demo4">
            <form data-bind='{"username":"","email":"","message":""}'>
                <label>„É¶„Éº„Ç∂„ÉºÂêç:</label>
                <input type="text" name="username" placeholder="ÂêçÂâç„ÇíÂÖ•Âäõ">

                <label>„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ:</label>
                <input type="text" name="email" placeholder="„É°„Éº„É´@example.com">

                <label>„É°„ÉÉ„Çª„Éº„Ç∏:</label>
                <textarea name="message" rows="3" placeholder="„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÂÖ•Âäõ"></textarea>

                <div class="output">
                    <h3>ÂÖ•ÂäõÂÜÖÂÆπ:</h3>
                    <p><strong>„É¶„Éº„Ç∂„ÉºÂêç:</strong> {{username}}</p>
                    <p><strong>„É°„Éº„É´:</strong> {{email}}</p>
                    <p><strong>„É°„ÉÉ„Çª„Éº„Ç∏:</strong> {{message}}</p>
                </div>
            </form>
            <button class="show-dom-btn" data-demo-id="demo4">DOM„ÇíË°®Á§∫</button>
            <div id="dom-demo4" class="dom-viewer" style="display:none;"></div>
        </div>

        <!-- 5. Ë°åÊìç‰Ωú (ËøΩÂä†„ÉªÂâäÈô§) -->
        <h2>5. Ë°åÊìç‰Ωú (ËøΩÂä†„ÉªÂâäÈô§„Éª‰∏¶„Å≥Êõø„Åà)</h2>
        <div class="demo-section" id="demo5">
            <div data-bind='{"items":[{"name":"È†ÖÁõÆ1"},{"name":"È†ÖÁõÆ2"}]}'>
                <div class="output">
                    <ul data-each="items" data-each-key="name">
                        <li>
                            <input type="text" name="name" value="{{name}}" style="width: 200px;">
                            <button data-click-row-prev>‚Üë</button>
                            <button data-click-row-next>‚Üì</button>
                            <button data-click-row-add>‚ûï ËøΩÂä†</button>
                            <button data-click-row-remove style="background: #f44336;">üóëÔ∏è ÂâäÈô§</button>
                        </li>
                    </ul>
                </div>
            </div>
            <button class="show-dom-btn" data-demo-id="demo5">DOM„ÇíË°®Á§∫</button>
            <div id="dom-demo5" class="dom-viewer" style="display:none;"></div>
        </div>

        <!-- 6. „Ç´„Ç¶„É≥„Çø„Éº (adjust) -->
        <h2>6. „Ç´„Ç¶„É≥„Çø„Éº (data-click-adjust)</h2>
        <div class="demo-section" id="demo6">
            <div data-bind='{"counter":0}'>
                <div class="output">
                    <p style="font-size: 24px;"><strong>„Ç´„Ç¶„É≥„Éà:</strong> {{counter}}</p>
                </div>
                <input type="number" id="counter" name="counter" value="{{counter}}" readonly>
                <div>
                    <button data-click-adjust="#counter" data-click-adjust-value="1">+1</button>
                    <button data-click-adjust="#counter" data-click-adjust-value="5">+5</button>
                    <button data-click-adjust="#counter" data-click-adjust-value="-1">-1</button>
                    <button data-click-adjust="#counter" data-click-adjust-value="-5">-5</button>
                    <button data-click-reset="#counter" style="background: #ff9800;">„É™„Çª„ÉÉ„Éà</button>
                </div>
            </div>
            <button class="show-dom-btn" data-demo-id="demo6">DOM„ÇíË°®Á§∫</button>
            <div id="dom-demo6" class="dom-viewer" style="display:none;"></div>
        </div>

        <!-- 7. „ÉÄ„Ç§„Ç¢„É≠„Ç∞„Å®„Éà„Éº„Çπ„Éà -->
        <h2>7. „ÉÄ„Ç§„Ç¢„É≠„Ç∞„Å®„Éà„Éº„Çπ„Éà</h2>
        <div class="demo-section" id="demo7">
            <button data-click-dialog="„Åì„Çå„ÅØ„ÉÄ„Ç§„Ç¢„É≠„Ç∞„É°„ÉÉ„Çª„Éº„Ç∏„Åß„ÅôÔºÅ">„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíË°®Á§∫</button>
            <button data-click-toast="„Éà„Éº„Çπ„ÉàÈÄöÁü•„ÅåË°®Á§∫„Åï„Çå„Åæ„Åó„Åü" style="background: #FF9800;">„Éà„Éº„Çπ„Éà„ÇíË°®Á§∫</button>
            <button
                data-click-confirm="Êú¨ÂΩì„Å´ÂÆüË°å„Åó„Åæ„Åô„ÅãÔºü"
                data-click-toast="ÂÆüË°å„Åó„Åæ„Åó„ÅüÔºÅ"
                style="background: #f44336;">
                Á¢∫Ë™ç‰ªò„Åç„Ç¢„ÇØ„Ç∑„Éß„É≥
            </button>
            <button class="show-dom-btn" data-demo-id="demo7">DOM„ÇíË°®Á§∫</button>
            <div id="dom-demo7" class="dom-viewer" style="display:none;"></div>
        </div>

        <!-- 8. Ë®àÁÆóÂºè -->
        <h2>8. Ë®àÁÆóÂºè</h2>
        <div class="demo-section" id="demo8">
            <form data-bind='{"price":1000,"quantity":1,"taxRate":0.1}'>
                <label>Âçò‰æ°:</label>
                <input type="number" name="price" value="{{price}}">

                <label>Êï∞Èáè:</label>
                <input type="number" name="quantity" value="{{quantity}}">

                <label>Ê∂àË≤ªÁ®éÁéá:</label>
                <select name="taxRate">
                    <option value="0.08">8%</option>
                    <option value="0.1" selected>10%</option>
                </select>

                <div class="output">
                    <p><strong>Â∞èË®à:</strong> {{price * quantity}}ÂÜÜ</p>
                    <p><strong>Ê∂àË≤ªÁ®é:</strong> {{Math.floor(price * quantity * taxRate)}}ÂÜÜ</p>
                    <p><strong>ÂêàË®à:</strong> {{price * quantity + Math.floor(price * quantity * taxRate)}}ÂÜÜ</p>
                </div>
            </form>
            <button class="show-dom-btn" data-demo-id="demo8">DOM„ÇíË°®Á§∫</button>
            <div id="dom-demo8" class="dom-viewer" style="display:none;"></div>
        </div>

        <!-- 9. „Éç„Çπ„Éà„Åó„Åü„Éá„Éº„Çø -->
        <h2>9. „Éç„Çπ„Éà„Åó„Åü„Éá„Éº„Çø</h2>
        <div class="demo-section" id="demo9">
            <div data-bind='{"user":{"name":"Â±±Áî∞Â§™ÈÉé","profile":{"age":35,"email":"yamada@example.com","address":"Êù±‰∫¨ÈÉΩÊ∏ãË∞∑Âå∫"}}}'>
                <div class="output">
                    <h3>„É¶„Éº„Ç∂„ÉºÊÉÖÂ†±</h3>
                    <p><strong>ÂêçÂâç:</strong> {{user.name}}</p>
                    <p><strong>Âπ¥ÈΩ¢:</strong> {{user.profile.age}}Ê≠≥</p>
                    <p><strong>„É°„Éº„É´:</strong> {{user.profile.email}}</p>
                    <p><strong>‰ΩèÊâÄ:</strong> {{user.profile.address}}</p>
                </div>
            </div>
            <button class="show-dom-btn" data-demo-id="demo9">DOM„ÇíË°®Á§∫</button>
            <div id="dom-demo9" class="dom-viewer" style="display:none;"></div>
        </div>

    </div>

    <script type="module">
        import Haori from '../src/index.ts';

        // Haori„ÅÆÂàùÊúüÂåñ
        const haori = new Haori();

        // DOMË°®Á§∫„Éú„Çø„É≥„ÅÆ„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºË®≠ÂÆö
        document.addEventListener('click', function(e) {
            const button = e.target.closest('.show-dom-btn');
            if (!button) return;

            const demoId = button.getAttribute('data-demo-id');
            if (!demoId) return;

            const section = document.getElementById(demoId);
            const domViewer = document.getElementById('dom-' + demoId);

            if (domViewer.style.display === 'none') {
                const html = section.querySelector('.demo-section > div, .demo-section > form')?.outerHTML || section.innerHTML;
                domViewer.textContent = formatHTML(html);
                domViewer.style.display = 'block';
            } else {
                domViewer.style.display = 'none';
            }
        });

        function formatHTML(html) {
            let formatted = '';
            let indent = 0;

            html.split(/(<[^>]+>)/g).forEach(function(node) {
                if (node.match(/^<\/\w/)) {
                    indent--;
                }

                if (node.trim()) {
                    formatted += '  '.repeat(Math.max(0, indent)) + node.trim() + '\n';
                }

                if (node.match(/^<\w[^>]*[^\/]>$/)) {
                    indent++;
                }
            });

            return formatted;
        }
    </script>
</body>
</html>
